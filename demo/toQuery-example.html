<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>toQuery() Function Example</title>
    <script src="../dist/form-default.js" type="module"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .column {
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 5px;
        }
        h1, h2 {
            color: #333;
        }
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .query-output {
            min-height: 200px;
        }
    </style>
</head>
<body>
    <h1>toQuery() Function Example</h1>
    <p>This example demonstrates the new <code>toQuery()</code> function that generates SPARQL queries from SHACL-based forms.</p>
    
    <div class="container">
        <div class="column">
            <h2>SHACL Form</h2>
            <shacl-form id="example-form" data-shapes="
                @prefix sh:   <http://www.w3.org/ns/shacl#> .
                @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
                @prefix ex:   <http://example.org#> .
                @prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .

                ex:PersonShape
                    a sh:NodeShape, rdfs:Class ;
                    sh:targetClass ex:Person ;
                    sh:property [
                        sh:name 'Name' ;
                        sh:path ex:name ;
                        sh:datatype xsd:string ;
                        sh:minCount 1 ;
                        sh:maxCount 1 ;
                    ] ;
                    sh:property [
                        sh:name 'Email' ;
                        sh:path ex:email ;
                        sh:datatype xsd:string ;
                    ] ;
                    sh:property [
                        sh:name 'Age' ;
                        sh:path ex:age ;
                        sh:datatype xsd:integer ;
                    ] .
            "></shacl-form>
            
            <div style="margin-top: 20px;">
                <button onclick="generateConstructQuery()">Generate CONSTRUCT Query</button>
                <button onclick="generateSelectQuery()">Generate SELECT Query</button>
            </div>
        </div>
        
        <div class="column">
            <h2>Generated SPARQL Query</h2>
            <pre id="query-output" class="query-output">Click a button to generate a query...</pre>
        </div>
    </div>
    
    <div style="margin-top: 20px; padding: 15px; background-color: #e7f3fe; border-left: 4px solid #2196F3;">
        <h3>How it works:</h3>
        <ul>
            <li>Fill in the form fields with some values</li>
            <li>Click "Generate CONSTRUCT Query" to create a CONSTRUCT query that can be used to retrieve matching data from a SPARQL endpoint</li>
            <li>Click "Generate SELECT Query" to create a SELECT query that returns variables instead of constructing triples</li>
            <li>The generated query includes filters based on the values you entered in the form</li>
            <li>Note: The toQuery() function only generates the query string; it does not execute the query</li>
        </ul>
    </div>

    <script>
        const form = document.getElementById('example-form');
        const output = document.getElementById('query-output');
        
        function generateConstructQuery() {
            try {
                const query = form.toQuery('construct');
                output.textContent = query;
            } catch (error) {
                output.textContent = 'Error: ' + error.message;
            }
        }
        
        function generateSelectQuery() {
            try {
                const query = form.toQuery('select');
                output.textContent = query;
            } catch (error) {
                output.textContent = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
